<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#191a1b">
    
    <title>Employees Â· Email Management | IntegrityNet</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@6.5.95/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/forms.css">
    <link rel="stylesheet" href="css/components/tables.css">
    <link rel="stylesheet" href="css/components/modals.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <img src="img/icon.svg" alt="logo" class="logo">
            <span class="logo-text">Phone Directory</span>
        </div>

        <div class="header-center">
            <ul class="header-menu">

                <!--<li class="active"><a>Employees</a></li>
                <li><a href="groups.html">Groups</a></li>
                <li><a href="domains.html">Domains</a></li>-->
            </ul>
        </div>

        <div class="header-right">
            <button class="action-button system-pref-button" role="switch" aria-label="light/dark mode">
                <svg class="system-pref system-pref--dark-mode" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
            </button>
            <audio src="audio/light-on.mp3" class="theme-audio--light-on" data-attribute="adapted from user 160033 file on freesound.org https://freesound.org/people/160033/sounds/366184/ under CC BY-NC 3.0"></audio>
            <audio src="audio/light-off.mp3" class="theme-audio--light-off" data-attribute="adapted from user 160033 file on freesound.org https://freesound.org/people/160033/sounds/366184/ under CC BY-NC 3.0"></audio>

            <div type="circle" class="account">
                <div class="account-avatar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                </div>
                
                <div class="account-text">
                    <div class="account-text__name">harold</div>
                    <div class="account-text__dept">dev</div>
                </div>
            </div>
        </div>
    </header>

    <main class="content">
        <section class="section section--employees">
            <div class="row section-header">
                <div class="col-06 md-06 tab-full section-header__heading">
                   
                    <h1 class="section-header__heading-text">Phone Directories</h1>
                </div>
                <div class="col-06 md-06 tab-full section-header__action">
                    <button class="ids-btn primary-btn rounded-5-btn" data-target="addEmployee" data-toggle="modal"><i class="mdi mdi-plus"></i> Add</button>
                </div>
            </div>
            
            <div class="row section-body">
                <div class="col-12">
                    <form class="form-search-employees">
                        <div class="textfield-wrapper">
                            <div class="textfield-inner with-leading textfield-action">
                                <input type="search" name="textfield-search-employees" placeholder="Search Employees" class="search-employee-input">
                                <i class="mdi mdi-magnify textfield-icon textfield-icon--leading"></i>
                                <div class="textfield-cta">
                                    <button class="ids-btn primary-btn small-btn rounded-5-btn">Search</button>
                                </div>
                            </div>
                            <div class="textfield-help is-invisible">
                                <div class="textfield-message"></div>
                            </div>
                        </div>
                    </form>
                </div>
    
              
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="copyright">
            &copy; IntegrityNet Solutions &amp; Services <script>document.write(new Date().getFullYear())</script> 
        </div>
    </footer>

    <div id="addEmployee" class="modal modal-default modal-top">
        <div class="modal-content">
            <div class="modal-content--inner">
                <div class="row modal-header">
                    <div class="col-full">
                        <div class="modal-header__title">
                            <svg class="modal-header__title-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user-plus"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="8.5" cy="7" r="4"></circle><line x1="20" y1="8" x2="20" y2="14"></line><line x1="23" y1="11" x2="17" y2="11"></line></svg>
                            <h3>Add Phone Directories</h3>
                        </div>
                    </div>

                    <a class="ids-fab-btn action-btn--right close-modal">
                        <i class="mdi mdi-close"></i>
                    </a>
                </div>

                <div class="row modal-body">
                    <div class="col-full">
                        <form>
                            <div class="textfield-wrapper">
                                <label for="emailAddress">Email Address</label>
                                <div class="textfield-inner with-leading">
                                    <input type="text" name="emailAddress" placeholder="Email Address">
                                    <i class="mdi mdi-email-outline textfield-icon textfield-icon--leading"></i>
                                </div>
                            </div>
                            
                            <div class="textfield-wrapper">
                                <label for="new-password">New Password</label>
                                <div class="textfield-inner textfield-inner--password with-both-icons">
                                    <input type="password" name="new-password" placeholder="Password">
                                    <i class="mdi mdi-lock-outline textfield-icon textfield-icon--leading"></i>
                                    <i class="mdi mdi-eye textfield-icon textfield-icon--trailing"></i>
                                </div>
                                <div class="textfield-help hidden">
                                    <div class="textfield-message"><i class="mdi mdi-alert-circle"></i> Error message</div>
                                </div>
                            </div>
                            
                            <div class="textfield-wrapper">
                                <label for="confirm-password">Confirm Password</label>
                                <div class="textfield-inner textfield-inner--password with-both-icons">
                                    <input type="password" name="confirm-password" placeholder="Confirm Password">
                                    <i class="mdi mdi-lock-outline textfield-icon textfield-icon--leading"></i>
                                    <i class="mdi mdi-eye textfield-icon textfield-icon--trailing"></i>
                                </div>
                                <div class="textfield-help hidden">
                                    <div class="textfield-message"><i class="mdi mdi-alert-circle"></i> Error message</div>
                                </div>
                            </div>

                            <button type="submit" class="ids-btn primary-btn medium-btn rounded-5-btn">Create Email</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="deleteEmployee" class="modal modal-default modal-top">
        <div class="modal-content">
            <div class="modal-content--inner">
                <div class="row modal-header">
                    <div class="col-full">
                        <div class="modal-header__title">
                            <svg class="modal-header__title-icon"  xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                            <h3>Delete Employee Email</h3>
                        </div>
                    </div>

                    <a class="ids-fab-btn action-btn--right close-modal">
                        <i class="mdi mdi-close"></i>
                    </a>
                </div>

                <div class="row modal-body">
                    <div class="col-full">
                        <form>
                            <div class="textfield-wrapper">
                                <label for="emailAddress">Email Address</label>
                                <div class="textfield-inner with-leading">
                                    <input type="text" name="emailAddress" placeholder="Email Address">
                                    <i class="mdi mdi-email-outline textfield-icon textfield-icon--leading"></i>
                                </div>
                            </div>
                            
                            <div class="textfield-wrapper">
                                <label for="new-password">New Password</label>
                                <div class="textfield-inner textfield-inner--password with-both-icons">
                                    <input type="password" name="new-password" placeholder="Password">
                                    <i class="mdi mdi-lock-outline textfield-icon textfield-icon--leading"></i>
                                    <i class="mdi mdi-eye textfield-icon textfield-icon--trailing"></i>
                                </div>
                                <div class="textfield-help hidden">
                                    <div class="textfield-message"><i class="mdi mdi-alert-circle"></i> Error message</div>
                                </div>
                            </div>
                            
                            <div class="textfield-wrapper">
                                <label for="confirm-password">Confirm Password</label>
                                <div class="textfield-inner textfield-inner--password with-both-icons">
                                    <input type="password" name="confirm-password" placeholder="Confirm Password">
                                    <i class="mdi mdi-lock-outline textfield-icon textfield-icon--leading"></i>
                                    <i class="mdi mdi-eye textfield-icon textfield-icon--trailing"></i>
                                </div>
                                <div class="textfield-help hidden">
                                    <div class="textfield-message"><i class="mdi mdi-alert-circle"></i> Error message</div>
                                </div>
                            </div>

                            <button type="submit" class="ids-btn primary-btn medium-btn rounded-5-btn">Create Email</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/theme.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        // Body overflow for modals
		const modalOpen = function() {
		    document.body.classList.add('modal-open');
		};

		const noModalOpen = function() {
            document.body.classList.remove('modal-open');
		};

        // Add employee modal with data-target and toggle
		document.addEventListener('click', function (e) {
			e = e || window.event;
			var target = e.target || e.srcElement;

			if (target.hasAttribute('data-toggle') && target.getAttribute('data-toggle') == 'modal' || target.closest('.primary-btn')) {
				if (target.hasAttribute('data-target') || target.parent) {
					var modalID = target.getAttribute('data-target');
					document.getElementById(modalID).classList.add('modal-active');
					e.preventDefault();
					modalOpen();
				}
			}

			if ((target.hasAttribute('data-dismiss') && target.getAttribute('data-dismiss') == 'modal') || target.closest('.close-modal') || target.classList.contains('modal')) {
				var modal = document.querySelector('.modal.modal-active');
				modal.classList.remove('modal-active');
				e.preventDefault();
				noModalOpen();
			}
		}, false);

        // Add employee modal close with escape button
		document.body.addEventListener('keydown', (e) => {
			if (e.key === 'Escape') {
				console.log(e);
				document.querySelector('.close-modal').click();  
			}
		});

        // Toggle Password (jQuery)
        const togglePassword = function() {
            $('.textfield-inner--password').on('click', '.textfield-icon--trailing', function(){
                textfieldPassword = $(this).parent().find("input");
                if (textfieldPassword.attr("type") == "password") {
                    textfieldPassword.attr("type", "text");
                } else {
                    textfieldPassword.attr("type", "password");
                }

                $(this).toggleClass('mdi-eye mdi-eye-off');
            });
        }
        togglePassword();
	

        // Test Employee Data
        const API_URL = 'https://api.themoviedb.org/3/discover/movie?sort_by=popularity.desc&api_key=3fd2be6f0c70a2a598f084ddfb75487c&page=1'
        const IMG_PATH = 'https://image.tmdb.org/t/p/w1280'
        const SEARCH_API = 'https://api.themoviedb.org/3/search/movie?api_key=3fd2be6f0c70a2a598f084ddfb75487c&query="'

        const employeeTable = document.querySelector('.employee-table > tbody');
        const employeeSearch = document.querySelector('.form-search-employees');
        const employeeSearchInput = document.querySelector('.search-employee-input');

        getEmployees(API_URL)

        async function getEmployees(url) {
            const res = await fetch(url)
            const data = await res.json()

            showEmployees(data.results)
        }

        function showEmployees(employees) {
            employeeTable.innerHTML = ''

            employeeTable.classList.add('hello');
            employeeTable.classList.remove('hello');

            employees.forEach(employee => {
                const { title, poster_path, vote_average, overview } = employee

                const employeeEl = document.createElement('tr')
                employeeEl.classList.add('employee')

                employeeEl.innerHTML = `
                    <td><span class="${getClassByRate(vote_average)}">${vote_average}</span></td>
                    <td><img src="${IMG_PATH + poster_path}" alt="${title}"></td>
                    <td>${title}</td>
                    <td>${overview}</td>
                    <td>
                        <button class="ids-btn primary-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                        </button>
                    </td>
                `

                employeeTable.appendChild(employeeEl);
            });
        }

        function deleteEmployee(employee) {
            // employee.forEach
        }

        function getClassByRate(vote) {
            if (vote >= 8) {
                return 'green'
            } else if (vote >= 5) {
                return 'orange'
            } else {
                return 'red'
            }
        }

        employeeSearch.addEventListener('submit', (e) => {
            e.preventDefault()

            const searchTerm = employeeSearchInput.value

            if(searchTerm && searchTerm !== '') {
                getEmployees(SEARCH_API + searchTerm)

                employeeSearchInput.value = ''

                const searchResultText = employeeSearchInput.closest('.textfield-inner').nextElementSibling;

                searchResultText.classList.remove('is-invisible');
                searchResultText.querySelector('.textfield-message');
                searchResultText.innerHTML = `You have searched for&nbsp;<span class="search-term">${searchTerm}</span>`
            } else {
                window.location.reload()
                searchResultText.classList.add('is-invisible');
            }
        })
    </script>
</body>
</html>